# WARP.md

This file provides guidance to WARP (warp.dev) when working with code in this repository.

# Shelton's Bash Guide - Astro + Starlight Documentation

This is a documentation site built with Astro and Starlight framework for creating technical documentation.

## Essential Commands

Use JPD if installed; otherwise use PNPM.

**Development:**
- Install dependencies: `jpd install` | `pnpm install`
- Start dev server: `jpd run dev` | `pnpm dev` (serves at localhost:4321)
- Build for production: `jpd run build` | `pnpm build`
- Preview production build: `jpd run preview` | `pnpm preview`
- Type and content checks: `jpd run astro check` | `pnpm astro check`
- Spell check: `jpd run spell:check` | `pnpm spell:check`
- Spell check with suggestions: `jpd run spell:fix` | `pnpm spell:fix`

**Astro CLI:**
- Add integrations: `jpd run astro add <integration>` | `pnpm astro add <integration>`
- CLI help: `jpd run astro --help` | `pnpm astro --help`

**Requirements:**
- Node.js ≥ 18.14 (LTS 20+ recommended)
- On Linux: prefer installing executables with Nix

## Architecture Overview

**Project Structure:**
- `astro.config.mjs` - Main Astro configuration and Starlight integration setup
- `src/content/docs/` - All documentation content (Markdown/MDX files)
- `src/content.config.ts` - Content collections configuration
- `public/` - Static assets (favicons, images, robots.txt)
- `src/assets/` - Build-time processed assets

**Content Organization:**
- `src/content/docs/index.mdx` - Homepage with hero section and cards
- `src/content/docs/guides/` - How-to guides and tutorials
- `src/content/docs/reference/` - Reference documentation
- Navigation is configured in `astro.config.mjs` under `starlight.sidebar`

**Key Concepts:**
- Starlight automatically generates routes from file structure
- Frontmatter controls page metadata, sidebar appearance, and SEO
- Sidebar can use manual items or autogenerate from directory structure
- Images in `src/assets/` are optimized; images in `public/` served as-is

## Content Authoring

**Create a new page:**
1. Add `.md` or `.mdx` file under `src/content/docs/<section>/<slug>.md`
2. Include frontmatter for metadata:
```yaml
---
title: Page Title
description: Page description for SEO and cards
sidebar:
  label: Sidebar Label
  order: 1
---
```

**Starlight Features:**
- Built-in components: Cards, CardGrid, Aside, Badge, etc.
- Automatic table of contents
- Search functionality
- Dark/light mode toggle
- Responsive navigation

**Links and Assets:**
- Internal links: `/guides/example/` (absolute from site root)
- Images: `![Alt text](../../assets/image.png)` or from `public/`
- For shared assets, use `public/` directory

## Documentation Quality Standards

**Writing Principles:**
- **Clarity over cleverness** - Write for understanding, not to impress
- **Concise but complete** - Include necessary context without verbosity  
- **Scannable structure** - Use headings, lists, and code blocks effectively
- **Practical examples** - Every concept should have a working example
- **Progressive disclosure** - Start simple, add complexity gradually

**Content Review Checklist:**
- [ ] Title and description are clear and searchable
- [ ] Introduction explains what/why before how
- [ ] Code examples are tested and complete
- [ ] Commands include expected output when helpful
- [ ] Screenshots/diagrams are current and accessible (alt text)
- [ ] Internal links work and external links are stable
- [ ] Grammar and spelling are correct
- [ ] Frontmatter sidebar order makes logical sense

**Quality Gates:**
- Run `pnpm astro check` before committing (catches broken links, typos)
- Run `pnpm spell:check` before committing (validates spelling)
- Preview content locally with `pnpm dev` to verify formatting
- Test all code examples in the documented environment
- Verify navigation flow makes sense to newcomers

## Customization

**Branding:**
- Update `title` and `social` links in `astro.config.mjs`
- Replace logo/favicon in `public/`
- Custom CSS: create `src/styles/custom.css`

**Sidebar Configuration:**
- Manual items: defined in `astro.config.mjs`
- Auto-generated: use `autogenerate: { directory: 'reference' }`
- Mixed: combine manual items with autogenerated sections

## Git Workflow & CI/CD

This project uses **CI-centric Git Flow** with GitHub Actions automation. Initialize with `git flow init` if not already done.

**CI-Centric Workflow:**
- `main` branch is always deployable
- `develop` branch for ongoing feature integration
- No dedicated release branches - merge `develop` to `main` frequently
- Production hotfixes: branch from `main`, merge back to both `main` and `develop`

**Feature Development:**
- Start: `git flow feature start <feature-name>`
- Finish: `git flow feature finish <feature-name>` (merges to `develop`)
- Deploy: Merge `develop` to `main` when stable

**Production Hotfixes:**
- Create from `main`: `git checkout -b fix/critical-issue main`
- Merge to `main` and deploy immediately
- Merge back to `develop`: `git checkout develop && git merge fix/critical-issue`

**Commit Message Format (Strict):**
```
<type>(<scope>)<!>: <subject ≤ 64 chars>

# <optional subtitle ≤ 72 chars>

<body wrapped at ~72 chars>

<footer: BREAKING CHANGE, issue refs, etc.>
```
Types: feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert, remove, wip, merge
Examples:
- `docs(guides): add bash scripting fundamentals`
- `docs(reference): improve command examples`
- `fix(content): correct broken internal links`

**GitHub Actions Workflows:**
- **Quality Check** (`.github/workflows/quality-check.yml`) - Runs on PRs and develop pushes
  - Astro type/content validation
  - Spell checking with cspell
  - Build verification
- **Deploy** (`.github/workflows/deploy.yml`) - Runs on main branch pushes  
  - Quality checks before deployment
  - Builds and deploys to GitHub Pages
- **Preview** (`.github/workflows/preview.yml`) - Runs on PRs to develop
  - Quality validation for preview builds
  - Generates build summary in PR comments

## Development Notes

**VSCode Integration:**
- Astro extension recommended (configured in `.vscode/extensions.json`)
- Debug configuration available in `.vscode/launch.json`

**Common Tasks:**
- Add new documentation section: create folder under `src/content/docs/`
- Update navigation: modify `sidebar` in `astro.config.mjs`
- Add integrations: `pnpm astro add <integration>` (sitemap, rss, etc.)
- Check for broken links: `pnpm astro check`

**Spell Checking:**
- Configuration: `cspell.json` - includes technical dictionaries and custom words
- Add project-specific terms to the `words` array in `cspell.json`
- Code blocks, inline code, and URLs are automatically ignored

**Troubleshooting:**
- Content not appearing: verify frontmatter and sidebar configuration
- Build errors: run `pnpm astro check` for diagnostics
- Spell check failures: add technical terms to `cspell.json` words array
- Node version issues: ensure Node ≥ 18.14, prefer LTS versions
